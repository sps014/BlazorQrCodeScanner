@page "/"
@using BlazorQrCodeScanner
@using System.Drawing

<QrCodeScanner @ref="qrCodeScanner" OnCreated="InstanceCreated" Style="width:100%;height:400px"/>

@code
{
	private QrCodeScanner? qrCodeScanner;

	protected override Task OnInitializedAsync()
	{
		return base.OnInitializedAsync();
	}
	private void InstanceCreated()
	{
		qrCodeScanner?.StartAsync(
			new Dictionary<string, object> { ["facingMode"] = "environment" },
		new QrCodeConfig()
			{
				QrBox = new QrBoxFunction(QrBoxFunc)
			});
	}

	private SizeF QrBoxFunc(SizeF viewPortSize)
	{
		double minEdgePercentage = 0.999; // 70%
		double minEdgeSize = Math.Min(viewPortSize.Width, viewPortSize.Height);
		int qrboxSize = (int)Math.Floor(minEdgeSize * minEdgePercentage);

		return new(qrboxSize, 150);
	}
}